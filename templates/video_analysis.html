<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Analysis ‚Äî FitVerse</title>
    <link rel="icon" type="image/jpeg" href="{{ url_for('static', filename='images/logo.jpeg') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/video_analysis.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
</head>
<body>

    <!-- ===== NAVBAR ===== -->
    <nav class="navbar">
        <div class="navbar-inner">
            <a href="/" class="navbar-brand" aria-label="FitVerse">
                <img class="brand-logo" src="{{ url_for('static', filename='images/logo.jpeg') }}" alt="FitVerse">
            </a>
            <div class="navbar-links">
                <a href="/" class="nav-link">Live Camera</a>
                <a href="/video_analysis" class="nav-link active">Video Analysis</a>
                <a href="/dashboard" class="nav-link">Dashboard</a>
                <a href="/profile" class="nav-link">Profile</a>
            </div>
            <button class="nav-hamburger" id="nav-hamburger" aria-label="Menu">
                <span></span><span></span><span></span>
            </button>
        </div>
        <div class="navbar-mobile" id="navbar-mobile">
            <a href="/" class="nav-link">Live Camera</a>
            <a href="/video_analysis" class="nav-link active">Video Analysis</a>
            <a href="/dashboard" class="nav-link">Dashboard</a>
            <a href="/profile" class="nav-link">Profile</a>
        </div>
    </nav>

    <!-- ===== PAGE CONTENT ===== -->
    <div class="page-wrapper">
        <!-- Page header band -->
        <div class="page-header">
            <div class="container">
                <h1>üé¨ Video Analysis</h1>
                <p>Upload a workout video to analyze your exercise form with AI</p>
            </div>
        </div>

        <div class="container">
            <div class="main-content">

                <!-- ===== LEFT: VIDEO PANEL ===== -->
                <div class="video-panel">
                    <!-- Video Display -->
                    <div class="video-container" id="video-container">
                        <div class="upload-area" id="upload-area">
                            <span class="upload-icon">üìÅ</span>
                            <h3>Drop video here or click to upload</h3>
                            <p>Supports: MP4, AVI, MOV, WebM</p>
                            <input type="file" id="video-input" accept="video/*" hidden>
                            <button class="btn primary-btn" id="browse-btn">Browse Files</button>
                        </div>
                        <video id="video-player" controls hidden>
                            Your browser does not support the video tag.
                        </video>
                        <canvas id="analysis-canvas" hidden></canvas>
                    </div>

                    <!-- Video Controls -->
                    <div class="video-controls">
                        <div class="progress-container">
                            <div class="progress-bar" id="analysis-progress">
                                <div class="progress-fill" id="progress-fill"></div>
                            </div>
                            <span id="progress-text">0%</span>
                        </div>
                        <div class="control-buttons">
                            <button class="btn secondary-btn" id="play-btn" disabled>‚ñ∂ Play</button>
                            <button class="btn primary-btn" id="analyze-btn" disabled>üîç Analyze</button>
                            <button class="btn secondary-btn" id="stop-analysis-btn" disabled>‚èπ Stop</button>
                            <button class="btn btn-outline" id="reset-btn" disabled>‚Ü∫ Reset</button>
                        </div>
                    </div>
                </div>

                <!-- ===== RIGHT: ANALYSIS PANEL ===== -->
                <div class="analysis-panel">

                    <!-- Exercise Selection -->
                    <div class="section exercise-selection">
                        <h2>üèãÔ∏è Select Exercise</h2>
                        <select id="exercise-select" class="exercise-dropdown">
                            <option value="">‚Äî Select Exercise ‚Äî</option>
                        </select>
                        <div id="exercise-info-panel" class="exercise-info-mini hidden">
                            <span id="mini-type" class="mini-badge"></span>
                            <p id="mini-description"></p>
                        </div>
                    </div>

                    <!-- Live Statistics -->
                    <div class="section stats-section">
                        <h2>üìä Live Statistics</h2>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <span class="stat-label">Repetitions</span>
                                <span class="stat-value" id="stat-reps">0</span>
                            </div>
                            <div class="stat-card">
                                <span class="stat-label">Form Score</span>
                                <span class="stat-value" id="stat-score">--</span>
                            </div>
                            <div class="stat-card">
                                <span class="stat-label">Grade</span>
                                <span class="stat-value grade" id="stat-grade">--</span>
                            </div>
                            <div class="stat-card">
                                <span class="stat-label">State</span>
                                <span class="stat-value small" id="stat-state">--</span>
                            </div>
                        </div>
                    </div>

                    <!-- Form Quality Gauge -->
                    <div class="section gauge-section">
                        <h2>üéØ Form Quality</h2>
                        <div class="gauge-container">
                            <svg class="gauge" viewBox="0 0 200 120">
                                <path class="gauge-bg" d="M 20 100 A 80 80 0 0 1 180 100" />
                                <path class="gauge-fill" id="gauge-fill" d="M 20 100 A 80 80 0 0 1 180 100" />
                            </svg>
                            <div class="gauge-value" id="gauge-value">--</div>
                        </div>
                    </div>

                    <!-- Form Feedback -->
                    <div class="section feedback-section">
                        <h2>üí¨ Form Feedback</h2>
                        <div class="feedback-log" id="feedback-log">
                            <div class="feedback-item info">
                                <span class="feedback-time">--:--</span>
                                <span class="feedback-text">Upload a video and start analysis to see feedback</span>
                            </div>
                        </div>
                    </div>

                    <!-- Analysis Report -->
                    <div class="section report-section hidden" id="report-section">
                        <h2>üìã Analysis Report</h2>
                        <div class="report-content" id="report-content">
                            <!-- Filled by JS after analysis -->
                        </div>
                        <button class="btn" id="download-report-btn">üì• Download Report</button>
                    </div>

                </div><!-- /analysis-panel -->
            </div><!-- /main-content -->

            <!-- ===== PROCESSING TERMINAL ===== -->
            <div class="terminal-section" id="terminal-section">
                <div class="terminal-header">
                    <span class="terminal-title">üìü Processing Log</span>
                    <div class="terminal-controls">
                        <span class="terminal-status" id="terminal-status">‚óè Idle</span>
                        <button class="terminal-toggle" id="terminal-toggle">‚ñº</button>
                    </div>
                </div>
                <div class="terminal-body" id="terminal-body">
                    <div class="terminal-content" id="terminal-content">
                        <div class="log-line info">[System] Ready for video analysis‚Ä¶</div>
                    </div>
                </div>
            </div>

        </div><!-- /container -->
    </div><!-- /page-wrapper -->

    <script src="{{ url_for('static', filename='js/video_analysis.js') }}"></script>
    <script>
        // Hamburger menu
        const hamburger = document.getElementById('nav-hamburger');
        const mobileNav = document.getElementById('navbar-mobile');
        if (hamburger && mobileNav) {
            hamburger.addEventListener('click', () => mobileNav.classList.toggle('open'));
        }
    </script>
</body>
</html>
